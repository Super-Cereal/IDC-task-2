var $jscomp$this=this,$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(d){return d.raw=d};$jscomp.createTemplateTagFirstArgWithRaw=function(d,f){d.raw=f;return d};
var votePageParser=function(d,f){var a={alias:"leaders",data:{title:"\u0421\u0430\u043c\u044b\u0439 \ud83d\udd0e \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a",subtitle:"\u0421\u043f\u0440\u0438\u043d\u0442 \u2116 "+d.getCurrentSprintId(),emoji:"\ud83d\udd0e",users:[]}},b=d.getUsers(),e=d.countLikesToCommentsByUsers(f),c;for(c in e){var g=Object.assign({},b[c],{valueText:e[c]});a.data.users.push(g)}a.data.users.sort(function(h,
k){return k.valueText-h.valueText});a.data.users=a.data.users.map(function(h){return Object.assign({},h,{valueText:h.valueText+" \u0433\u043e\u043b\u043e\u0441\u043e\u0432"})});return a},leadersPageParser=function(d,f){var a={alias:"leaders",data:{title:"\u0411\u043e\u043b\u044c\u0448\u0435 \u0432\u0441\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432",subtitle:"\u0421\u043f\u0440\u0438\u043d\u0442 \u2116 "+d.getCurrentSprintId(),emoji:"\ud83d\udc51",users:[]}},b=d.getUsers(),e=
d.countCommitsByUsers(f),c;for(c in b){var g=Object.assign({},b[c],{valueText:e[c]});a.data.users.push(g)}a.data.users.sort(function(h,k){return k.valueText-h.valueText});return a},chartPageParser=function(d,f,a){var b=d.getCurrentSprintId();f={alias:"chart",data:{title:"\u041a\u043e\u043c\u043c\u0438\u0442\u044b",subtitle:"\u0421\u043f\u0440\u0438\u043d\u0442 \u2116 "+b,users:f,values:[]}};for(var e=f.data.values,c=-6;4>c;c++)if(0===c)e.push({title:b,value:a.length,active:!0});else if(!(0>=b+c)){var g=
d.getSprintById(b+c);g=d.getSprintCommits(g);e.push({title:b+c,value:g.length})}return f},diagramPageParser=function(d,f){function a(k,q){var p=k.getSummaries(),l=[0,0,0,0];k.getSprintCommits(k.getSprintById(q)).forEach(function(t){var m=0;t.summaries.forEach(function(n){var r;n=null!=(r=n.id)?r:n;m+=p[n].added+p[n].removed});1001<=m?l[0]++:501<=m?l[1]++:101<=m?l[2]++:1<=m&&l[3]++});return l}var b=d.getCurrentSprintId(),e={alias:"diagram",data:{title:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432",
subtitle:"\u0421\u043f\u0440\u0438\u043d\u0442 \u2116 "+b,totalText:"",differenceText:"",categories:[{title:"> 1001 \u0441\u0442\u0440\u043e\u043a\u0438",valueText:"30 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432",differenceText:"+8 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432"},{title:"501 \u2014 1000 \u0441\u0442\u0440\u043e\u043a",valueText:"32 \u043a\u043e\u043c\u043c\u0438\u0442\u0430",differenceText:"+6 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432"},{title:"101 \u2014 500 \u0441\u0442\u0440\u043e\u043a",
valueText:"58 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432",differenceText:"+16 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432"},{title:"1 \u2014 100 \u0441\u0442\u0440\u043e\u043a",valueText:"62 \u043a\u043e\u043c\u043c\u0438\u0442\u0430",differenceText:"+12 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432"}]}},c=function(k){return k.reduce(function(q,p){return q+p})},g=a(d,b-1);b=a(d,b);e.data.totalText=c(b)+" \u043a\u043e\u043c\u043c\u0438\u0442\u0430";c=c(b)-c(g);e.data.differenceText=(0<=
c?"+":"")+c+" \u0441 \u043f\u0440\u043e\u0448\u043b\u043e\u0433\u043e \u0441\u043f\u0440\u0438\u043d\u0442\u0430";for(c=0;4>c;c++){e.data.categories[c].valueText=b[c]+" \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432";var h=b[c]-g[c];e.data.categories[c].differenceText=(0<=h?"+":"")+h+" \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432"}return e},activityPageParser=function(d,f,a){d={alias:"activity",data:{title:"\u041a\u043e\u043c\u043c\u0438\u0442\u044b, 1 \u043d\u0435\u0434\u0435\u043b\u044f",
subtitle:"\u0421\u043f\u0440\u0438\u043d\u0442 \u2116 "+d.getCurrentSprintId(),data:{mon:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tue:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],wed:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],thu:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fri:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sat:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sun:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}};var b=d.data.data;a.forEach(function(e){var c=
e.timestamp-f.startAt;e=Math.floor(c/864E5);c=Math.floor(c%864E5/36E5);0===e&&b.mon[c]++;1===e&&b.tue[c]++;2===e&&b.wed[c]++;3===e&&b.thu[c]++;4===e&&b.fri[c]++;5===e&&b.sat[c]++;6===e&&b.sun[c]++});return d},controlPanel={init:function(d,f){$jscomp$this.sprintId=f;$jscomp$this.entities={User:{},Project:[],Sprint:[],Commit:[],Summary:{},Issue:[],Comment:[]};d.forEach(function(a){switch(a.type){case "User":$jscomp$this.entities.User[a.id]={id:a.id,name:a.name,avatar:a.avatar,valueText:""};break;case "Summary":$jscomp$this.entities.Summary[a.id]=
a;break;default:$jscomp$this.entities[a.type].push(a)}})},getCurrentSprintId:function(){return $jscomp$this.sprintId},getUsers:function(){return $jscomp$this.entities.User},getSummaries:function(){return $jscomp$this.entities.Summary},getSprintById:function(d){var f;return null!=(f=$jscomp$this.entities.Sprint.find(function(a){return a.id===d}))?f:{startAt:-1,finishAt:-1}},getSprintCommits:function(d){var f=d.startAt,a=d.finishAt;return $jscomp$this.entities.Commit.filter(function(b){return f<=b.timestamp&&
b.timestamp<=a})},countCommitsByUsers:function(d){var f={};d.forEach(function(a){var b;a=null!=(b=a.author.id)?b:a.author;f[a]=a in f?f[a]+1:1});return f},countLikesToCommentsByUsers:function(d){var f=d.startAt,a=d.finishAt,b={};$jscomp$this.entities.Comment.forEach(function(e){if(f<=e.createdAt&&e.createdAt<=a){var c,g=null!=(c=e.author.id)?c:e.author;if(g in b){var h;b[g]+=(null!=(h=e.likes)?h:[]).length}else{var k;b[g]=(null!=(k=e.likes)?k:[]).length}}});return b}},prepareData=function(d,f){var a=
f.sprintId;controlPanel.init(d,a);a=controlPanel.getSprintById(a);var b=controlPanel.getSprintCommits(a),e=leadersPageParser(controlPanel,b),c=chartPageParser(controlPanel,e.data.users.slice(0,3),b),g=diagramPageParser(controlPanel);b=activityPageParser(controlPanel,a,b);return[votePageParser(controlPanel,a),e,c,g,b]};module.exports={prepareData:prepareData};